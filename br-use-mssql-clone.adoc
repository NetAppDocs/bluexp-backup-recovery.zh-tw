---
sidebar: sidebar 
permalink: br-use-mssql-clone.html 
keywords: backing up, restoring, back up, backup, clone, restore, cloud volumes ontap, aws, azure, s3, blob, google cloud, storagegrid, back up volumes, cloud backup, restore volumes, cost, on-premises ontap, onprem, applications, virtual machines, backup and recovery 
summary: 複製 Microsoft SQL Server 應用程式數據，用於開發、測試或保護目的。您可以基於 Microsoft SQL Server 工作負載的即時快照或現有快照建立複製。 
---
= 使用BlueXP backup and recoveryMicrosoft SQL Server 工作負載
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
使用BlueXP backup and recovery，將 Microsoft SQL Server 應用程式資料複製到相同或不同的虛擬機，用於開發、測試或保護目的。您可以從 Microsoft SQL Server 工作負載的即時快照或現有快照建立複製。

從以下克隆類型中進行選擇：

* *即時快照與複製*：您可以透過即時快照建立 Microsoft SQL Server 工作負載的複製。即時快照是根據備份建立的來源資料的時間點副本。克隆儲存在您的公有雲或私有雲帳戶的物件儲存中。如果資料遺失或損壞，您可以使用克隆來恢復工作負載。
* *從現有快照複製*：您可以從工作負載可用的快照清單中選擇現有快照。如果您想從特定時間點建立克隆，此選項非常有用。克隆到主存儲或輔助存儲。


您可以實現以下保護目標：

* 創建克隆
* 重新整理實體複本
* 分割實體複本
* 刪除克隆


*必要的BlueXP角色* 組織管理員、資料夾或專案管理員、備份和還原超級管理員或備份和還原複製管理員角色。  https://docs.netapp.com/us-en/bluexp-setup-admin/reference-iam-predefined-roles.html["了解所有服務的 BlueXP 存取角色"^] 。



== 創建克隆

您可以建立 Microsoft SQL Server 工作負載的複製。克隆是透過備份建立的來源資料的副本。克隆儲存在您的公有雲或私有雲帳戶的物件儲存中。如果資料遺失或損壞，您可以使用克隆來恢復工作負載。

您可以從現有快照或即時快照建立複製。即時快照是根據備份建立的來源資料的時間點副本。如果資料遺失或損壞，您可以使用克隆來恢復工作負載。

.步驟
. 從BlueXP backup and recovery選單中，選擇 *複製*。
+
image:screen-br-sql-clone-nomenu.png["BlueXP backup and recovery的克隆頁面截圖"]

. 選擇*建立新克隆*。
. 選擇克隆類型：
+
** *從現有快照克隆並刷新資料庫*：選擇要克隆的快照並配置克隆選項。如果您要選擇要複製的快照並配置選項，這將非常有用。
** *即時快照和複製*：立即建立來源資料的快照，並基於該快照建立複製。如果您想基於來源工作負載中的最新資料建立克隆，此選項非常有用。


. 完成*資料庫來源*部分：
+
** *單一克隆或批次克隆*：選擇建立單一克隆或多個克隆。如果選擇“批次克隆”，則可以使用已建立的保護群組一次建立多個克隆。如果您想要為不同的工作負載建立多個克隆，此選項非常有用。
** *來源資料庫主機、執行個體和名稱*：選擇複製的來源資料庫主機、執行個體和名稱。來源資料庫是用於建立克隆的資料庫。


. 完成*資料庫目標*部分：
+
** *目標資料庫主機、執行個體和名稱*：選擇複製的目標資料庫主機、執行個體和名稱。目標資料庫是克隆創建的位置。
+
（可選）從目標名稱下拉清單中選擇“*後綴*”，並為克隆的資料庫名稱附加後綴。如果不指定後綴，則複製的資料庫名稱將與來源資料庫名稱相同。

** *QoS（最大吞吐量）*：選擇複製的服務品質 (QoS) 最大吞吐量（以 MBps 為單位）。 QoS定義了克隆的效能特徵，例如最大吞吐量和 IOPS。


. 完成*Mount*部分：
+
** 自動指派掛載點：選擇此選項可自動為複製指派掛載點。掛載點是克隆在物件儲存中掛載的位置。
** *定義掛載點路徑*：輸入複製的掛載點。掛載點是克隆在物件儲存中掛載的位置。選擇磁碟機號，輸入資料檔案路徑，並輸入日誌檔案路徑。


. 選擇*下一步*。
. 選擇還原點：
+
** *現有快照*：從工作負載可用的快照清單中選擇現有快照。如果您想從特定時間點建立克隆，此選項非常有用。
** *即時快照和克隆*：從工作負載可用的快照清單中選擇最新的快照。如果您想要從來源工作負載中的最新資料建立克隆，此選項非常有用。


. 如果您選擇建立*即時快照和複製*，請選擇複製儲存位置：
+
** *本機儲存*：選擇此選項可在ONTAP系統的本機儲存中建立複製。本機儲存是直接連接到ONTAP系統的儲存。
** *二級儲存*：選擇此選項可在ONTAP系統的二級儲存中建立克隆。二級儲存是用於備份和還原工作負載的儲存。


. 選擇資料和日誌的目標位置。
. 選擇*下一步*。
. 完成“進階選項”部分：
+
image:screen-br-sql-clone-create-advanced.png["BlueXP backup and recovery中建立克隆的進階設置"]

. 如果您選擇*即時快照和克隆*，請完成以下選項：
+
image:screen-br-sql-clone-create-instantsnapshot-advanced.png["BlueXP backup and recovery中建立即時快照和複製的進階設置"]

+
** *克隆刷新計劃和到期日期*：如果您選擇*即時複製*，請輸入開始刷新克隆的日期。克隆計劃定義了克隆的創建時間。
+
*** *如果計劃到期則刪除克隆*：如果您想在克隆到期日後刪除克隆。
*** *刷新克隆間隔*：選擇克隆的刷新頻率。您可以選擇每小時、每天、每週、每月或每季刷新一次克隆。如果您希望克隆與來源工作負載保持同步，此選項非常有用。


** *前言和後記*：可選地，指定在克隆創建前後運行的克隆前和克隆後腳本。這些腳本可用於執行其他任務，例如配置複製或發送通知。
** *通知*：（選用）指定用於接收複製建立狀態通知以及作業報告的電子郵件地址。您也可以指定用於接收複製建立狀態通知的 Webhook URL。您可以指定是否需要成功和失敗通知，或僅需要其中一種通知。
** *標籤*：選擇一個或多個標籤，以便您稍後搜尋資源組，然後選擇*套用*。例如，如果您將「HR」作為標籤新增至多個資源群組，則稍後可以找到與 HR 標籤關聯的所有資源群組。


. 選擇* Create *（建立*）。
. 當克隆創建完成後，您可以在*庫存*頁面中查看它。 image:screen-br-inventory.png["BlueXP backup and recovery的庫存頁面螢幕截圖"]




== 重新整理實體複本

您可以刷新 Microsoft SQL Server 工作負載的克隆。刷新克隆會使用來源工作負載的最新資料更新克隆。如果您想讓克隆與來源工作負載保持同步，刷新操作非常有用。

您可以選擇變更資料庫名稱、使用最新的即時快照或從現有生產快照刷新。

.步驟
. 從BlueXP backup and recovery選單中，選擇 *複製*。
. 選擇要刷新的克隆。
. 選擇“操作”圖標image:../media/icon-action.png["操作選項"] > *刷新克隆*。
+
image:screen-br-sql-clone-refresh-options.png["刷新BlueXP backup and recovery的克隆選項"]

. 完成“進階設定”部分：
+
** *復原範圍*：選擇還原所有日誌備份或還原到特定時間點的日誌備份。如果您想將克隆恢復到特定時間點，此選項非常有用。
** *克隆刷新計劃和到期日期*：如果您選擇*即時複製*，請輸入開始刷新克隆的日期。克隆計劃定義了克隆的創建時間。
+
*** *如果計劃到期則刪除克隆*：如果您想在克隆到期日後刪除克隆。
*** *刷新克隆間隔*：選擇克隆的刷新頻率。您可以選擇每小時、每天、每週、每月或每季刷新一次克隆。如果您希望克隆與來源工作負載保持同步，此選項非常有用。


** *iGroup 設定*：選擇克隆的 igroup。 igroup是用於存取複製的啟動器的邏輯分組。您可以選擇現有 igroup，也可以建立新的 igroup。從主 ONTAP 儲存系統或輔助ONTAP儲存系統中選擇 igroup。
** *前言和後記*：可選地，指定在克隆創建前後運行的克隆前和克隆後腳本。這些腳本可用於執行其他任務，例如配置複製或發送通知。
** *通知*：（選用）指定用於接收複製建立狀態通知以及作業報告的電子郵件地址。您也可以指定用於接收複製建立狀態通知的 Webhook URL。您可以指定是否需要成功和失敗通知，或僅需要其中一種通知。
** *標籤*：輸入一個或多個標籤，方便您稍後搜尋資源組。例如，如果您將「HR」作為標籤新增至多個資源群組，則稍後可以找到與該 HR 標籤關聯的所有資源群組。


. 在刷新確認對話方塊中，若要繼續，請選擇*刷新*。




== 跳過克隆刷新

如果您不想使用來源工作負載中的最新資料來更新克隆，則可能需要跳過克隆刷新。跳過克隆刷新可讓您保持克隆的原樣，而無需進行更新。

.步驟
. 從BlueXP backup and recovery選單中，選擇 *複製*。
. 選擇您想要跳過刷新的克隆。
. 選擇“操作”圖標image:../media/icon-action.png["操作選項"] > *跳過刷新*。
. 在「跳過刷新確認」對話方塊中，執行以下操作：
+
.. 若要僅跳過下一個刷新計劃，請選擇*僅跳過下一個刷新計劃*。
.. 若要繼續，請選擇*跳過*。






== 分割實體複本

您可以拆分 Microsoft SQL Server 工作負載的複製。拆分克隆會從該克隆建立新的備份。新的備份可用於還原工作負載。

您可以選擇將克隆拆分為獨立克隆或長期克隆。精靈會顯示 SVM 的聚合清單、其大小以及複製磁碟區的位置。 BlueXPBlueXP backup and recovery也會指示是否有足夠的空間來分割克隆。克隆拆分後，克隆將成為獨立的資料庫以提供保護。

克隆作業不會被刪除，並且可以再次用於其他克隆。

.步驟
. 從BlueXP backup and recovery選單中，選擇 *複製*。
. 選擇一個克隆。
. 選擇“操作”圖標image:../media/icon-action.png["操作選項"] > *分裂克隆*。
+
image:screen-br-sql-clone-split.png["BlueXP backup and recovery的拆分克隆頁面"]

. 查看拆分克隆詳細資訊並選擇*拆分*。
. 當分裂克隆創建完成後，您可以在*庫存*頁面中查看它。 image:screen-br-inventory.png["BlueXP backup and recovery的庫存頁面螢幕截圖"]




== 刪除克隆

您可以刪除 Microsoft SQL Server 工作負載的複製。刪除克隆會將其從物件儲存中移除，從而釋放儲存空間。

如果克隆受到策略保護，則會刪除該克隆，包括作業。

.步驟
. 從BlueXP backup and recovery選單中，選擇 *複製*。
. 選擇一個克隆。
. 選擇“操作”圖標image:../media/icon-action.png["操作選項"] > *刪除克隆*。
. 在複製刪除確認對話方塊中，查看刪除詳細資訊。
+
.. 若要從SnapCenter中刪除複製的資源，即使無法存取複製或其存儲，也請選擇「強制刪除」。
.. 選擇*刪除*。


. 當克隆被刪除時，它將從*庫存*頁面中刪除。

